--
-- PostgreSQL database dump
--

-- Dumped from database version 12.22 (Ubuntu 12.22-0ubuntu0.20.04.4)
-- Dumped by pg_dump version 12.22 (Ubuntu 12.22-0ubuntu0.20.04.4)

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: commentaires; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.commentaires (
    id bigint NOT NULL,
    contenu text NOT NULL,
    date_creation timestamp(6) without time zone NOT NULL,
    is_internal boolean NOT NULL,
    auteur_id bigint NOT NULL,
    ticket_id bigint NOT NULL
);


ALTER TABLE public.commentaires OWNER TO postgres;

--
-- Name: commentaires_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.commentaires ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.commentaires_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: notifications; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.notifications (
    id bigint NOT NULL,
    date_creation timestamp(6) without time zone NOT NULL,
    date_envoi timestamp(6) without time zone,
    date_lecture timestamp(6) without time zone,
    envoye boolean NOT NULL,
    lu boolean NOT NULL,
    message text NOT NULL,
    titre character varying(255) NOT NULL,
    type character varying(50) NOT NULL,
    ticket_id bigint,
    utilisateur_id bigint NOT NULL
);


ALTER TABLE public.notifications OWNER TO postgres;

--
-- Name: notifications_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.notifications ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.notifications_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: roles; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.roles (
    id bigint NOT NULL,
    description character varying(500),
    name character varying(255) NOT NULL,
    CONSTRAINT roles_name_check CHECK (((name)::text = ANY ((ARRAY['ROLE_CITOYEN'::character varying, 'ROLE_AGENT_TRAITEMENT'::character varying, 'ROLE_AGENT_SUPPORT'::character varying, 'ROLE_ADMIN_SUPPORT'::character varying])::text[])))
);


ALTER TABLE public.roles OWNER TO postgres;

--
-- Name: roles_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.roles ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.roles_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: ticket_historique; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.ticket_historique (
    id bigint NOT NULL,
    action character varying(100) NOT NULL,
    ancienne_valeur text,
    commentaire text,
    date_action timestamp(6) without time zone NOT NULL,
    nouvelle_valeur text,
    ticket_id bigint NOT NULL,
    utilisateur_id bigint NOT NULL
);


ALTER TABLE public.ticket_historique OWNER TO postgres;

--
-- Name: ticket_historique_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.ticket_historique ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.ticket_historique_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: tickets; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tickets (
    id bigint NOT NULL,
    categorie character varying(500),
    date_cloture timestamp(6) without time zone,
    date_creation timestamp(6) without time zone NOT NULL,
    date_escalade timestamp(6) without time zone,
    date_modification timestamp(6) without time zone,
    description text NOT NULL,
    numero_ticket character varying(255) NOT NULL,
    priorite character varying(255) NOT NULL,
    resolution text,
    statut character varying(255) NOT NULL,
    titre character varying(255) NOT NULL,
    type character varying(255) NOT NULL,
    assigne_a_id bigint,
    createur_id bigint NOT NULL,
    CONSTRAINT tickets_priorite_check CHECK (((priorite)::text = ANY ((ARRAY['BASSE'::character varying, 'MOYENNE'::character varying, 'HAUTE'::character varying, 'URGENTE'::character varying])::text[]))),
    CONSTRAINT tickets_statut_check CHECK (((statut)::text = ANY ((ARRAY['OUVERT'::character varying, 'EN_COURS'::character varying, 'RESOLU'::character varying, 'CLOS'::character varying, 'ESCALADE'::character varying])::text[]))),
    CONSTRAINT tickets_type_check CHECK (((type)::text = ANY ((ARRAY['INCIDENT'::character varying, 'RECLAMATION'::character varying, 'DEMANDE'::character varying])::text[])))
);


ALTER TABLE public.tickets OWNER TO postgres;

--
-- Name: tickets_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.tickets ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.tickets_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: user_roles; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.user_roles (
    user_id bigint NOT NULL,
    role_id bigint NOT NULL
);


ALTER TABLE public.user_roles OWNER TO postgres;

--
-- Name: users; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.users (
    id bigint NOT NULL,
    actif boolean NOT NULL,
    adresse character varying(500),
    date_creation timestamp(6) without time zone NOT NULL,
    date_modification timestamp(6) without time zone,
    derniere_connexion timestamp(6) without time zone,
    email character varying(150) NOT NULL,
    nom character varying(100) NOT NULL,
    password character varying(255),
    prenom character varying(100) NOT NULL,
    telephone character varying(20)
);


ALTER TABLE public.users OWNER TO postgres;

--
-- Name: users_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.users ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.users_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Data for Name: commentaires; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.commentaires (id, contenu, date_creation, is_internal, auteur_id, ticket_id) FROM stdin;
\.


--
-- Data for Name: notifications; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.notifications (id, date_creation, date_envoi, date_lecture, envoye, lu, message, titre, type, ticket_id, utilisateur_id) FROM stdin;
1	2025-11-17 17:39:35.184236	\N	\N	f	f	Votre ticket 'Problème de connexion au portail' a été créé avec succès. Numéro: TKT-1763401175161	Nouveau ticket créé: TKT-1763401175161	EMAIL	2	2
2	2025-11-17 17:58:08.768999	\N	\N	f	f	Votre ticket 'Paiement fait mais aucun feedback' a été créé avec succès. Numéro: TKT-1763402288764	Nouveau ticket créé: TKT-1763402288764	EMAIL	3	3
3	2025-11-17 18:02:44.861789	\N	\N	f	f	Votre ticket 'Nouveau ticket' a été créé avec succès. Numéro: TKT-1763402564856	Nouveau ticket créé: TKT-1763402564856	EMAIL	4	2
4	2025-11-21 17:00:59.267134	\N	\N	f	f	Votre ticket 'Paiement fait mais aucun feedback' a été créé avec succès. Numéro: TKT-1763744459236	Nouveau ticket créé: TKT-1763744459236	EMAIL	5	3
5	2025-11-22 20:29:42.223883	\N	\N	f	f	Le ticket 'Problème de connexion au portail' vous a été assigné. Priorité: HAUTE	Nouveau ticket assigné: TKT-1763401175161	EMAIL	2	4
6	2025-11-22 20:30:17.296727	\N	\N	f	f	Le ticket 'Problème de connexion au portail' vous a été assigné. Priorité: HAUTE	Nouveau ticket assigné: TKT-1763401175161	EMAIL	2	5
\.


--
-- Data for Name: roles; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.roles (id, description, name) FROM stdin;
1	Citoyen utilisant les services en ligne	ROLE_CITOYEN
2	Agent de traitement interne	ROLE_AGENT_TRAITEMENT
3	Agent support technique	ROLE_AGENT_SUPPORT
4	Administrateur du système de support	ROLE_ADMIN_SUPPORT
\.


--
-- Data for Name: ticket_historique; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.ticket_historique (id, action, ancienne_valeur, commentaire, date_action, nouvelle_valeur, ticket_id, utilisateur_id) FROM stdin;
1	CREATION	\N	\N	2025-11-17 17:39:35.179539	Ticket créé	2	2
2	CREATION	\N	\N	2025-11-17 17:58:08.767361	Ticket créé	3	3
3	CREATION	\N	\N	2025-11-17 18:02:44.859433	Ticket créé	4	2
4	CREATION	\N	\N	2025-11-21 17:00:59.263139	Ticket créé	5	3
5	ASSIGNATION	Non assigné	Ticket assigné à Dupont	2025-11-22 20:29:42.214061	agent1@justice.gov	2	4
6	ASSIGNATION	agent1@justice.gov	Ticket assigné à Martin	2025-11-22 20:30:17.292551	agent2@justice.gov	2	5
\.


--
-- Data for Name: tickets; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.tickets (id, categorie, date_cloture, date_creation, date_escalade, date_modification, description, numero_ticket, priorite, resolution, statut, titre, type, assigne_a_id, createur_id) FROM stdin;
3	Casier	\N	2025-11-17 17:58:08.76509	\N	2025-11-17 17:58:08.76511	j'ai payé mais cela ne fonctionne toujours pas	TKT-1763402288764	HAUTE	\N	OUVERT	Paiement fait mais aucun feedback	INCIDENT	\N	3
4	efff	\N	2025-11-17 18:02:44.856781	\N	2025-11-17 18:02:44.856801	Bien a	TKT-1763402564856	HAUTE	\N	OUVERT	Nouveau ticket	INCIDENT	\N	2
5	Casier	\N	2025-11-21 17:00:59.243876	\N	2025-11-21 17:00:59.243923	,nb;jhlkjh;jhl;jh;	TKT-1763744459236	HAUTE	\N	OUVERT	Paiement fait mais aucun feedback	DEMANDE	\N	3
2	Accès	\N	2025-11-17 17:39:35.161802	\N	2025-11-22 20:30:18.932304	Je ne peux pas accéder à mon dossier en ligne depuis ce matin	TKT-1763401175161	HAUTE	\N	EN_COURS	Problème de connexion au portail	INCIDENT	5	2
\.


--
-- Data for Name: user_roles; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.user_roles (user_id, role_id) FROM stdin;
1	4
2	1
3	4
4	3
5	3
\.


--
-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.users (id, actif, adresse, date_creation, date_modification, derniere_connexion, email, nom, password, prenom, telephone) FROM stdin;
2	t	\N	2025-11-17 17:22:45.294728	2025-11-17 17:22:45.294794	\N	test@test.com	Test	$2a$10$jNOfSB5kxnIuEMvhXD23Au3sn5KaZ3XT0nBT4R83y0Zv3jwc49vKa	User	0123456789
1	t	\N	2025-11-17 17:18:23.422658	2025-11-17 17:18:23.422706	\N	admin@justice.gov	Admin	$2a$10$k3FxRpCYGf5EG5qpQJ.0O.MjH5vV5pYU5PZNz8q5QKx8VZ5Cx6kxO	Système	0000000000
3	t	\N	2025-11-17 17:34:02.541974	2025-11-17 17:34:02.542042	\N	admin@justice.com	Admin	$2a$10$NVVOECTRRgw.Sc9DHyqWIOJz2jWCx3v8.O8Rd7zK.dvhQNKsQPm6S	System	\N
4	t	\N	2025-11-22 20:23:10.889334	2025-11-22 20:23:10.889374	\N	agent1@justice.gov	Dupont	$2a$10$3mR.5FAVuy09z0Gsz9ZMneIHMzgHD2xXt8SCJSvuMyEpp1le7hKG2	Pierre	\N
5	t	\N	2025-11-22 20:23:14.501573	2025-11-22 20:23:14.501604	\N	agent2@justice.gov	Martin	$2a$10$.956OssDOXjt8vASYpJfhu3mWXMrzqUJkPId86utFmbL7C3PsJbCq	Sophie	\N
\.


--
-- Name: commentaires_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.commentaires_id_seq', 1, false);


--
-- Name: notifications_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.notifications_id_seq', 6, true);


--
-- Name: roles_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.roles_id_seq', 4, true);


--
-- Name: ticket_historique_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.ticket_historique_id_seq', 6, true);


--
-- Name: tickets_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.tickets_id_seq', 5, true);


--
-- Name: users_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.users_id_seq', 5, true);


--
-- Name: commentaires commentaires_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.commentaires
    ADD CONSTRAINT commentaires_pkey PRIMARY KEY (id);


--
-- Name: notifications notifications_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.notifications
    ADD CONSTRAINT notifications_pkey PRIMARY KEY (id);


--
-- Name: roles roles_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.roles
    ADD CONSTRAINT roles_pkey PRIMARY KEY (id);


--
-- Name: ticket_historique ticket_historique_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.ticket_historique
    ADD CONSTRAINT ticket_historique_pkey PRIMARY KEY (id);


--
-- Name: tickets tickets_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tickets
    ADD CONSTRAINT tickets_pkey PRIMARY KEY (id);


--
-- Name: users uk2p58gbqhxvue2igoderm0gh2c; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT uk2p58gbqhxvue2igoderm0gh2c UNIQUE (telephone);


--
-- Name: users uk6dotkott2kjsp8vw4d0m25fb7; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT uk6dotkott2kjsp8vw4d0m25fb7 UNIQUE (email);


--
-- Name: tickets ukk0msfrh058q2goawy9u1sig33; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tickets
    ADD CONSTRAINT ukk0msfrh058q2goawy9u1sig33 UNIQUE (numero_ticket);


--
-- Name: roles ukofx66keruapi6vyqpv6f2or37; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.roles
    ADD CONSTRAINT ukofx66keruapi6vyqpv6f2or37 UNIQUE (name);


--
-- Name: user_roles user_roles_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_roles
    ADD CONSTRAINT user_roles_pkey PRIMARY KEY (user_id, role_id);


--
-- Name: users users_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- Name: notifications fk4b9nwiuwiriy886edb58ypilw; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.notifications
    ADD CONSTRAINT fk4b9nwiuwiriy886edb58ypilw FOREIGN KEY (utilisateur_id) REFERENCES public.users(id);


--
-- Name: tickets fk4fsdek1xyqyblh83twtah1cv5; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tickets
    ADD CONSTRAINT fk4fsdek1xyqyblh83twtah1cv5 FOREIGN KEY (createur_id) REFERENCES public.users(id);


--
-- Name: commentaires fk9ln3ltemfs8wge22nx61vns9t; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.commentaires
    ADD CONSTRAINT fk9ln3ltemfs8wge22nx61vns9t FOREIGN KEY (auteur_id) REFERENCES public.users(id);


--
-- Name: ticket_historique fkffw99w26hshjenyljkrt4pre; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.ticket_historique
    ADD CONSTRAINT fkffw99w26hshjenyljkrt4pre FOREIGN KEY (ticket_id) REFERENCES public.tickets(id);


--
-- Name: commentaires fkgb3509n9bn2ckd35i91mghunk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.commentaires
    ADD CONSTRAINT fkgb3509n9bn2ckd35i91mghunk FOREIGN KEY (ticket_id) REFERENCES public.tickets(id);


--
-- Name: user_roles fkh8ciramu9cc9q3qcqiv4ue8a6; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_roles
    ADD CONSTRAINT fkh8ciramu9cc9q3qcqiv4ue8a6 FOREIGN KEY (role_id) REFERENCES public.roles(id);


--
-- Name: user_roles fkhfh9dx7w3ubf1co1vdev94g3f; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_roles
    ADD CONSTRAINT fkhfh9dx7w3ubf1co1vdev94g3f FOREIGN KEY (user_id) REFERENCES public.users(id);


--
-- Name: tickets fki174c0515v1fm7hdrdd7e9ifl; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tickets
    ADD CONSTRAINT fki174c0515v1fm7hdrdd7e9ifl FOREIGN KEY (assigne_a_id) REFERENCES public.users(id);


--
-- Name: notifications fkj3w62kxgc4ictrm6jxaroc28u; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.notifications
    ADD CONSTRAINT fkj3w62kxgc4ictrm6jxaroc28u FOREIGN KEY (ticket_id) REFERENCES public.tickets(id);


--
-- Name: ticket_historique fkmc4ks4dvwd667c7995lw5jevv; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.ticket_historique
    ADD CONSTRAINT fkmc4ks4dvwd667c7995lw5jevv FOREIGN KEY (utilisateur_id) REFERENCES public.users(id);


--
-- PostgreSQL database dump complete
--

